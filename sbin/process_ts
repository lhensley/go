#!/bin/bash
# process_ts
# Usage: process_ts <input_file> <root_work_path> <root_storage_path>
# No final / on either path. For system root, use ""

INSTRING=$1
ROOT_WORK_PATH=$2
ROOT_STORAGE_PATH=$3

INSTRING_LENGTH=${#INSTRING}
ROOT_WORK_PATH_LENGTH=${#ROOT_WORK_PATH}
RELATIVE_PATH_LENGTH=$[INSTRING_LENGTH-ROOT_WORK_PATH_LENGTH]
RELATIVE_PATH=${INSTRING: -$RELATIVE_PATH_LENGTH+1}
OUTSTRING=$3/$RELATIVE_PATH
NOEXTENSION="${INSTRING##*/}"

# So ...
# $ROOT_WORK_PATH
# $ROOT_STORAGE_PATH
# $RELATIVE_PATH
# $INSTRING
# $OUTSTRING

# # This section is for testing only. Normally, just comment it out.
echo "ROOT_WORK_PATH:     $ROOT_WORK_PATH"
echo "ROOT_STORAGE_PATH:  $ROOT_STORAGE_PATH"
echo "RELATIVE_PATH:      $RELATIVE_PATH"
echo "INSTRING:           $INSTRING"
echo "OUTSTRING:          $OUTSTRING"
echo "NOEXTENSION:        $NOEXTENSION"
echo ""

exit 0