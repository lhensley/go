#!/bin/bash
# cold-backup

# Include script setup file
	source script-setup
	if [ ! $FUNCTIONS_ARE_DEFINED ]; then echo $0: Functions not defined. Aborting; logger $0: Functions not defined. Aborting; exit 1; fi
	if [ ! $VARIABLES_ARE_DEFINED ]; then echo $0: Variables not defined. Aborting; logger $0: Variables not defined. Aborting; exit 1; fi

# Require root
	f_require_root

# $COLD_BACKUP_FILE_SYSTEM can't be root
	if [ "$COLD_BACKUP_FILE_SYSTEM" == "/" ]; then
		f_die "Backup file system cannot be /." true
		fi

echo "A" f_mount_ro_fs_as_rw "$COLD_BACKUP_FILE_SYSTEM"
echo "B" $(f_mount_ro_fs_as_rw "$COLD_BACKUP_FILE_SYSTEM")

# Make the cold backup file system writable
if ! $(f_mount_ro_fs_as_rw "$COLD_BACKUP_FILE_SYSTEM") ; then
	f_die "$COLD_BACKUP_FILE_SYSTEM is not mounted." true
	fi

# Include script footer file
	f_debug_variable "script_footer" "${PATHNAME[script_footer]}"
	source "${PATHNAME[script_footer]}"

exit 0
